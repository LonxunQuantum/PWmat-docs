---
sidebar_position: 4
title: PWMLFF
---

# Machine Learning Force Field

PWmat Machine Learning Force Field (PWMLFF) is an open source software under GNU license. It aims at generating force fields with accuracy comparable to Ab Initio Molecular Dynamics (AIMD). It is compatible with AIMD data with either **PWmat** or **VASP** format. You can access the code from https://github.com/LonxunQuantum/PWMLFF.


This package contains 8 types of features with translation, rotation, and permutation invariance, which are

        1. 2-body(2b)
        2. 3-body(3b)
        3. 2-body Gaussian(2bgauss)
        4. 3-body Cosine(3bcos)
        5. Moment Tensor Potential(MTP)
        6. Spectral Neighbor Analysis Potential(SNAP)
        7. DP-Chebyshev(dp1)
        8. DP-Gaussian(dp2)

and 4 engines for training and prediction, which are

        1. Linear Model
        2. Graphic Neural Netowrk (GNN)
        3. Deep Neural Netowrk with Kalman Filter optimizer(KFNN)
        4. DP-torch Network with Kalman Filter optimizer(KFDP)

A complete MLFF workflow contains 3 major steps. **First**, use eitehr PWmat or VASP to run AIMD calculation to generate training data (features and direvatives of features, .etc), and perform post-processing of the data. **Second**, run training to obtain the force field, and monitor the **validation** result to see if overfitting occurs; **Finally**, use the obtained force field to make inference.

There are two kinds of inference: **evaluation** and **prediction**. **Evaluation** is a more rigorous assessment of the force field. In practice, ene first prepares a MOVEMENT file generated by Ab Initio calculation, use the obtained force field to calculate energy and force, and compare them against the Ab Initio results. Error given by this test is usually larger than the error given in the validation.

In comparison, **prediction** solves real challenges. Like Ab Initio MD calculations, it starts with a initial configuration, and simulates the ensuing process based on the force field and the conditions specified. Both **LAMMPS** and **PWmat** can be used.
